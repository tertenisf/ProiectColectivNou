@*@model ProiectColectiv.Models.Parking*@
@{
    ViewData["Title"] = "Admin Map";
}
<br/>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        #map {
            height: 800px;
            width: 1200px;
        }

    </style>    
</head>
<body>
<div id="map"></div>
<script>
    var map;
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 46.770920, lng: 23.589920},
            zoom: 13
        });

        $.get("@Url.Action("GetAllLocation","AdminMap")",
            function(data, status) {
                var marker = [];
                var contentString = [];
                var infowindow = [];
                for (var i = 0; i < data.length; i++) {

                    marker[i] = new google.maps.Marker({
                        position: { lat: data[i].latitudine, lng: data[i].longitudine },
                        map: map
                    });

                    contentString[i] = '<div id="content">' +
                        '<div id="siteNotice">' +
                        '</div>' +
                        '<h1 id="firstHeading" class="firstHeading">' +
                        data[i].name +
                        '</h1>' +
                        '<div id="bodyContent">' +
                        '<p><b> Numar locuri Fast Charging: </b>' +
                        data[i].nrFastChargingSpots +
                        '<p><b> Numar locuri care nu-s Fast Charging: </b>' +
                        data[i].nrNormalChargingSpots +
                        '<a href="@Url.Action("Index", "ViewDetails")" ><p>View Details</a>' +
                        '<form asp-action="Edit"><div><input type="submit" value="Open" class="btn btn-success"> <input type="submit" value="Close" class="btn btn-danger"></div></form>';                  

                    infowindow[i] = new google.maps.InfoWindow({
                        content: contentString[i]
                    });
                    var mdl = marker[i];
                    google.maps.event.addListener(marker[i],
                        'click',
                        (function(mdl, i) {
                            return function () {
                                infowindow[i].open(map, marker[i]);
                                for (var j = 0; j < infowindow.length; j++) {
                                    if (j != i) {
                                        infowindow[j].close();
                                    }
                                    
                                }
                            }
                        })(marker[i], i));

                    //marker[i].addListener('click', function() {
                    //    infowindow[i].open(map, marker[i]);
                    //});
                }
            });

    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD9HfqjqR0VDGD5N1sCd_nU8qC7J5SXATM&callback=initMap"
        async defer></script>
</body>
</html>